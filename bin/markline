#!/usr/bin/env node

var path = require("path");
var fs = require("fs");
var commander = require('commander');
var spawn = require('win-spawn');
var markline = require("../index");

commander
  .version(require('../package').version)
  .usage('[options]')
  //.option('build', 'build markdown to markline page.')
  //.option('server', 'preview markdown to markline page.')
  .parse(process.argv);

commander.on('--help', function() {
  console.log('    build     build markdown to markline page.');
  console.log('    server    preview markdown to markline page.');
  console.log('');
});

var cwd = process.cwd();

var subargs = process.argv.slice(3);
var subcmd = commander.args[0];
var bin = executable(subcmd);


if (bin) {
  spawn(bin, subargs, {stdio: 'inherit', customFds: [0, 1, 2]});
} else {
  commander.help();
}

function executable(subcmd) {
  var bin = 'markline-' + subcmd;

  var local = path.join(__dirname, bin);
  if (fs.existsSync(local)) {
    return local;
  }
}

// vim:ft=javascript
